#pragma once
#include "ofMain.h"

class ofApp : public ofBaseApp{
public:
    void setup();
    void update();
    void draw();

    // カメレオン（今は球体）
    ofVec2f pos;      // 位置
    ofVec2f vel;      // 速度
    float radius;     // 半径
    ofColor color;    // 色
};

#include "ofApp.h"

//--------------------------------------------------------------
void ofApp::setup(){
    ofSetFrameRate(60);
    ofBackground(0);          // 黒背景
    ofSetCircleResolution(64);

    radius = 40.0f;

    // 画面サイズから初期位置をランダムに決定
    float w = ofGetWidth();
    float h = ofGetHeight();
    pos.set(ofRandom(radius, w - radius),
            ofRandom(radius, h - radius));

    // 速度ベクトルをランダムに
    float speed = 5.0f;
    float angle = ofRandom(TWO_PI);
    vel.set(cos(angle) * speed,
            sin(angle) * speed);

    // 色をランダム（HSVベース）
    float hue = ofRandom(0, 255);
    color.setHsb(hue, 220, 255);
}

//--------------------------------------------------------------
void ofApp::update(){
    // 位置更新
    pos += vel;

    float w = ofGetWidth();
    float h = ofGetHeight();

    // 左右の壁で反射
    if (pos.x < radius) {
        pos.x = radius;
        vel.x *= -1;
    } else if (pos.x > w - radius) {
        pos.x = w - radius;
        vel.x *= -1;
    }

    // 上下の壁で反射
    if (pos.y < radius) {
        pos.y = radius;
        vel.y *= -1;
    } else if (pos.y > h - radius) {
        pos.y = h - radius;
        vel.y *= -1;
    }
}

//--------------------------------------------------------------
void ofApp::draw(){
    ofSetColor(color);
    ofDrawCircle(pos, radius);
}
